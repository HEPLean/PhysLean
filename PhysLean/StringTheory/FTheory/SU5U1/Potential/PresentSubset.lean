/-
Copyright (c) 2025 Joseph Tooby-Smith. All rights reserved.
Released under Apache 2.0 license as described in the file LICENSE.
Authors: Joseph Tooby-Smith
-/
import PhysLean.StringTheory.FTheory.SU5U1.Potential.Basic
/-!

# Presence of W1 term

This module contains results related to the presence of a `W1` coupling
based on the additional `U(1)` charges carried by the `SU(5)` representations.

## Key results

- `termW1PresentSubsets`: The irreducible set of pairs of finite sets
  which if the first is a subset of `Q5` and the second is a subset of `Q10`,
  then `Q5` and `Q10` permit a `W1` coupling.

-/
namespace FTheory

namespace SU5U1
variable {I : CodimensionOneConfig}

namespace PotentialTerm

open CodimensionOneConfig


def chargeSubsetReduced (I : CodimensionOneConfig) : (T : PotentialTerm) → Finset T.ChargeType
  | μ =>
    let SqHd := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    SqHd.product SqHu
  | K2 =>
    let SqHd := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 1)
    SqHd.product (SqHu.product SQ10)
  | K1 =>
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 1)
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 2)
    SQ5.product SQ10
  | W4 =>
    let SqHd := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 1)
    SqHd.product (SqHu.product SQ5)
  | W3 =>
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 2)
    SqHu.product SQ5
  | W2 =>
    let SqHd := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 3)
    SqHd.product SQ10
  | W1 =>
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 1)
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 3)
    SQ5.product SQ10
  | Λ =>
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 2)
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 1)
    SQ5.product SQ10
  | β =>
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 1)
    SqHu.product SQ5
  | topYukawa =>
    let SqHu := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 2)
    SqHu.product SQ10
  | bottomYukawa =>
    let SqHd := {none} ∪ I.allowedBarFiveCharges.map ⟨Option.some, Option.some_injective ℤ⟩
    let SQ5 := I.allowedBarFiveCharges.powerset.filter (fun x => x.card ≤ 1)
    let SQ10 := I.allowedTenCharges.powerset.filter (fun x => x.card ≤ 1)
    SqHd.product (SQ5.product SQ10)

def presentReducSubsetExe (I : CodimensionOneConfig)  (T : PotentialTerm) : Finset T.ChargeType :=
  (chargeSubsetReduced I T).filter fun x => IsPresent T x

def presentSubsetExe (I : CodimensionOneConfig) (T : PotentialTerm) : Finset T.ChargeType :=
  let X1 := T.presentReducSubsetExe I
  let X2 := X1.filter (fun x => ∀ y ∈ X1, x = y ∨ ¬ (y ⊆ x))
  X2

local instance (n : ℕ) : OfNat (Option ℤ) n where
  ofNat := some n

local instance : Neg (Option ℤ) where
  neg x := match x with
    | none => none
    | some n => some (-n)

def presentSubsetSame : (T : PotentialTerm) → Finset T.ChargeType
  | μ => {(-3, -3), (-2, -2), (-1, -1), (0, 0), (1, 1), (2, 2), (3, 3)}
  | K2 => {(-3, 0, {3}), (-3, 1, {2}), (-3, 2, {1}), (-3, 3, {0}), (-2, -1, {3}),
    (-2, 0, {2}), (-2, 1, {1}), (-2, 2, {0}), (-2, 3, {-1}), (-1, -2, {3}), (-1, -1, {2}),
    (-1, 0, {1}), (-1, 1, {0}), (-1, 2, {-1}), (-1, 3, {-2}), (0, -3, {3}), (0, -2, {2}),
    (0, -1, {1}), (0, 0, {0}), (0, 1, {-1}), (0, 2, {-2}), (0, 3, {-3}), (1, -3, {2}),
    (1, -2, {1}), (1, -1, {0}), (1, 0, {-1}), (1, 1, {-2}), (1, 2, {-3}), (2, -3, {1}),
    (2, -2, {0}), (2, -1, {-1}), (2, 0, {-2}), (2, 1, {-3}), (3, -3, {0}), (3, -2, {-1}),
    (3, -1, {-2}), (3, 0, {-3})}
  | K1 => {({-3}, {-2, -1}), ({-3}, {-3, 0}), ({-2}, {-1}), ({-2}, {-2, 0}), ({-2}, {-3, 1}),
    ({-1}, {-1, 0}), ({-1}, {-2, 1}), ({-1}, {-3, 2}), ({0}, {0}), ({0}, {-1, 1}), ({0}, {-2, 2}),
    ({0}, {-3, 3}), ({1}, {0, 1}), ({1}, {-1, 2}), ({1}, {-2, 3}), ({2}, {1}), ({2}, {0, 2}),
    ({2}, {-1, 3}), ({3}, {1, 2}), ({3}, {0, 3})}
  | W4 => {(-3, -3, {-3}), (-3, -2, {-1}), (-3, -1, {1}), (-3, 0, {3}), (-2, -2, {-2}),
    (-2, -1, {0}), (-2, 0, {2}), (-1, -2, {-3}), (-1, -1, {-1}), (-1, 0, {1}), (-1, 1, {3}),
    (0, -1, {-2}), (0, 0, {0}), (0, 1, {2}), (1, -1, {-3}), (1, 0, {-1}), (1, 1, {1}), (1, 2, {3}),
    (2, 0, {-2}), (2, 1, {0}), (2, 2, {2}), (3, 0, {-3}), (3, 1, {-1}), (3, 2, {1}), (3, 3, {3})}
  | W3 => {(-3, {-3}), (-2, {-2}), (-2, {-3, -1}), (-1, {-1}), (-1, {-2, 0}), (-1, {-3, 1}),
    (0, {0}), (0, {-1, 1}), (0, {-2, 2}), (0, {-3, 3}), (1, {1}), (1, {0, 2}), (1, {-1, 3}),
    (2, {2}), (2, {1, 3}), (3, {3})}
   | W2 => {(-3, {1}), (-3, {-1, 2}), (-3, {-3, 3}), (-3, {0, 3}), (-3, {-2, 2, 3}),
    (-2, {0, 1}), (-2, {-2, 2}), (-2, {0, 2}), (-2, {-1, 1, 2}), (-2, {-1, 0, 3}),
    (-2, {-2, 1, 3}), (-2, {-3, 2, 3}), (-1, {-1, 1}), (-1, {0, 1}), (-1, {-3, 2}),
    (-1, {-1, 0, 2}), (-1, {-2, 1, 2}), (-1, {-1, 3}), (-1, {-2, 0, 3}), (-1, {-3, 1, 3}),
    (0, {0}), (0, {-2, 1}), (0, {-1, 2}), (0, {-3, 1, 2}), (0, {-2, -1, 3}), (1, {-1, 0}),
    (1, {-3, 1}), (1, {-1, 1}), (1, {-2, 0, 1}), (1, {-2, -1, 2}), (1, {-3, 0, 2}), (1, {-2, 3}),
    (1, {-3, -1, 3}), (2, {-2, 0}), (2, {-1, 0}), (2, {-2, -1, 1}), (2, {-3, 0, 1}), (2, {-2, 2}),
    (2, {-3, -1, 2}), (2, {-3, -2, 3}), (3, {-1}), (3, {-3, 0}), (3, {-2, 1}), (3, {-3, -2, 2}),
    (3, {-3, 3})}
  | W1 => {({-3}, {1}), ({-3}, {-1, 2}), ({-3}, {-3, 3}), ({-3}, {0, 3}), ({-3}, {-2, 2, 3}),
    ({-2}, {0, 1}), ({-2}, {-2, 2}), ({-2}, {0, 2}), ({-2}, {-1, 1, 2}), ({-2}, {-1, 0, 3}),
    ({-2}, {-2, 1, 3}), ({-2}, {-3, 2, 3}), ({-1}, {-1, 1}), ({-1}, {0, 1}), ({-1}, {-3, 2}),
    ({-1}, {-1, 0, 2}), ({-1}, {-2, 1, 2}), ({-1}, {-1, 3}), ({-1}, {-2, 0, 3}), ({-1}, {-3, 1, 3}),
    ({0}, {0}), ({0}, {-2, 1}), ({0}, {-1, 2}), ({0}, {-3, 1, 2}), ({0}, {-2, -1, 3}),
    ({1}, {-1, 0}), ({1}, {-3, 1}), ({1}, {-1, 1}), ({1}, {-2, 0, 1}), ({1}, {-2, -1, 2}),
    ({1}, {-3, 0, 2}), ({1}, {-2, 3}), ({1}, {-3, -1, 3}), ({2}, {-2, 0}), ({2}, {-1, 0}),
    ({2}, {-2, -1, 1}), ({2}, {-3, 0, 1}), ({2}, {-2, 2}), ({2}, {-3, -1, 2}), ({2}, {-3, -2, 3}),
    ({3}, {-1}), ({3}, {-3, 0}), ({3}, {-2, 1}), ({3}, {-3, -2, 2}), ({3}, {-3, 3})}
  | Λ => {({-1}, {2}), ({-2, -1}, {3}), ({0}, {0}), ({-3, 0}, {3}), ({-2, 0}, {2}),
    ({-1, 0}, {1}), ({1}, {-2}), ({-3, 1}, {2}), ({-2, 1}, {1}), ({-1, 1}, {0}), ({0, 1}, {-1}),
    ({-3, 2}, {1}), ({-2, 2}, {0}), ({-1, 2}, {-1}), ({0, 2}, {-2}), ({1, 2}, {-3}), ({-3, 3}, {0}),
    ({-2, 3}, {-1}), ({-1, 3}, {-2}), ({0, 3}, {-3})}
  | β => {(-3, {-3}), (-2, {-2}), (-1, {-1}), (0, {0}), (1, {1}), (2, {2}), (3, {3})}
  | topYukawa => {(-3, {-2, -1}), (-3, {-3, 0}), (-2, {-1}), (-2, {-2, 0}), (-2, {-3, 1}),
    (-1, {-1, 0}), (-1, {-2, 1}), (-1, {-3, 2}), (0, {0}), (0, {-1, 1}), (0, {-2, 2}), (0, {-3, 3}),
    (1, {0, 1}), (1, {-1, 2}), (1, {-2, 3}), (2, {1}), (2, {0, 2}), (2, {-1, 3}), (3, {1, 2}),
    (3, {0, 3})}
  | bottomYukawa => {(-3, {0}, {3}), (-3, {1}, {2}), (-3, {2}, {1}), (-3, {3}, {0}),
    (-2, {-1}, {3}), (-2, {0}, {2}), (-2, {1}, {1}), (-2, {2}, {0}), (-2, {3}, {-1}),
    (-1, {-2}, {3}), (-1, {-1}, {2}), (-1, {0}, {1}), (-1, {1}, {0}), (-1, {2}, {-1}),
    (-1, {3}, {-2}), (0, {-3}, {3}), (0, {-2}, {2}), (0, {-1}, {1}), (0, {0}, {0}), (0, {1}, {-1}),
    (0, {2}, {-2}), (0, {3}, {-3}), (1, {-3}, {2}), (1, {-2}, {1}), (1, {-1}, {0}), (1, {0}, {-1}),
    (1, {1}, {-2}), (1, {2}, {-3}), (2, {-3}, {1}), (2, {-2}, {0}), (2, {-1}, {-1}), (2, {0}, {-2}),
    (2, {1}, {-3}), (3, {-3}, {0}), (3, {-2}, {-1}), (3, {-1}, {-2}), (3, {0}, {-3})}

-- #eval  (presentSubsetExe .nextToNearestNeighbor bottomYukawa)
def presentSubsetNearest :  (T : PotentialTerm) → Finset T.ChargeType
  | μ => {(-14, -14), (-9, -9), (-4, -4), (1, 1), (6, 6), (11, 11)}
  | K2 => {(-14, 1, {13}), (-14, 6, {8}), (-14, 11, {3}), (-9, -4, {13}),
    (-9, 1, {8}), (-9, 6, {3}), (-9, 11, {-2}), (-4, -9, {13}), (-4, -4, {8}), (-4, 1, {3}),
    (-4, 6, {-2}), (-4, 11, {-7}), (1, -14, {13}), (1, -9, {8}), (1, -4, {3}), (1, 1, {-2}),
    (1, 6, {-7}), (1, 11, {-12}), (6, -14, {8}), (6, -9, {3}), (6, -4, {-2}), (6, 1, {-7}),
    (6, 6, {-12}), (11, -14, {3}), (11, -9, {-2}), (11, -4, {-7}), (11, 1, {-12})}
  | K1 => {({-14}, {-7}), ({-14}, {-12, -2}), ({-9}, {-7, -2}), ({-9}, {-12, 3}),
    ({-4}, {-2}), ({-4}, {-7, 3}), ({-4}, {-12, 8}), ({1}, {-2, 3}), ({1}, {-7, 8}),
    ({1}, {-12, 13}), ({6}, {3}), ({6}, {-2, 8}), ({6}, {-7, 13}), ({11}, {3, 8}),
    ({11}, {-2, 13})}
  | W4 => {(-14, -14, {-14}), (-14, -9, {-4}), (-14, -4, {6}), (-9, -9, {-9}),
    (-9, -4, {1}), (-9, 1, {11}), (-4, -9, {-14}), (-4, -4, {-4}), (-4, 1, {6}), (1, -4, {-9}),
    (1, 1, {1}), (1, 6, {11}), (6, -4, {-14}), (6, 1, {-4}), (6, 6, {6}), (11, 1, {-9}),
    (11, 6, {1}), (11, 11, {11})}
  | W3 => {(-14, {-14}), (-9, {-9}), (-9, {-14, -4}), (-4, {-4}), (-4, {-9, 1}),
    (-4, {-14, 6}), (1, {1}), (1, {-4, 6}), (1, {-9, 11}), (6, {6}), (6, {1, 11}), (11, {11})}
  | W2 => {(-14, {-2, 8}), (-14, {3, 8}), (-14, {-12, 13}), (-14, {-2, 3, 13}),
    (-14, {-7, 8, 13}), (-9, {3}), (-9, {-7, 8}), (-9, {-2, 13}), (-9, {-12, 8, 13}), (-4, {-2, 3}),
    (-4, {-12, 8}), (-4, {-2, 8}), (-4, {-7, 3, 8}), (-4, {-7, -2, 13}), (-4, {-12, 3, 13}),
    (1, {-7, 3}), (1, {-2, 3}), (1, {-7, -2, 8}), (1, {-12, 3, 8}), (1, {-7, 13}),
    (1, {-12, -2, 13}), (6, {-2}), (6, {-12, 3}), (6, {-7, 8}), (6, {-12, -7, 13}), (11, {-7, -2}),
    (11, {-7, 3}), (11, {-12, -2, 3}), (11, {-12, -7, 8}), (11, {-12, 13})}
  | W1 => {({-14}, {-2, 8}), ({-14}, {3, 8}), ({-14}, {-12, 13}),
    ({-14}, {-2, 3, 13}), ({-14}, {-7, 8, 13}), ({-9}, {3}), ({-9}, {-7, 8}), ({-9}, {-2, 13}),
    ({-9}, {-12, 8, 13}), ({-4}, {-2, 3}), ({-4}, {-12, 8}), ({-4}, {-2, 8}), ({-4}, {-7, 3, 8}),
    ({-4}, {-7, -2, 13}), ({-4}, {-12, 3, 13}), ({1}, {-7, 3}), ({1}, {-2, 3}), ({1}, {-7, -2, 8}),
    ({1}, {-12, 3, 8}), ({1}, {-7, 13}), ({1}, {-12, -2, 13}), ({6}, {-2}), ({6}, {-12, 3}),
    ({6}, {-7, 8}), ({6}, {-12, -7, 13}), ({11}, {-7, -2}), ({11}, {-7, 3}), ({11}, {-12, -2, 3}),
    ({11}, {-12, -7, 8}), ({11}, {-12, 13})}
  | Λ => {({-4}, {8}), ({-9, -4}, {13}), ({1}, {-2}), ({-14, 1}, {13}),
    ({-9, 1}, {8}), ({-4, 1}, {3}), ({6}, {-12}), ({-14, 6}, {8}), ({-9, 6}, {3}), ({-4, 6}, {-2}),
    ({1, 6}, {-7}), ({-14, 11}, {3}), ({-9, 11}, {-2}), ({-4, 11}, {-7}), ({1, 11}, {-12})}
  | β => {(-14, {-14}), (-9, {-9}), (-4, {-4}), (1, {1}), (6, {6}), (11, {11})}
  | topYukawa => {(-14, {-7}), (-14, {-12, -2}), (-9, {-7, -2}), (-9, {-12, 3}),
    (-4, {-2}), (-4, {-7, 3}), (-4, {-12, 8}), (1, {-2, 3}), (1, {-7, 8}), (1, {-12, 13}), (6, {3}),
    (6, {-2, 8}), (6, {-7, 13}), (11, {3, 8}), (11, {-2, 13})}
  | bottomYukawa => {(-14, {1}, {13}), (-14, {6}, {8}), (-14, {11}, {3}),
    (-9, {-4}, {13}), (-9, {1}, {8}), (-9, {6}, {3}), (-9, {11}, {-2}), (-4, {-9}, {13}),
    (-4, {-4}, {8}), (-4, {1}, {3}), (-4, {6}, {-2}), (-4, {11}, {-7}), (1, {-14}, {13}),
    (1, {-9}, {8}), (1, {-4}, {3}), (1, {1}, {-2}), (1, {6}, {-7}), (1, {11}, {-12}),
    (6, {-14}, {8}), (6, {-9}, {3}), (6, {-4}, {-2}), (6, {1}, {-7}), (6, {6}, {-12}),
    (11, {-14}, {3}), (11, {-9}, {-2}), (11, {-4}, {-7}), (11, {1}, {-12})}


def presentSubsetNextToNearest : (T : PotentialTerm) → Finset T.ChargeType
  | μ => {(-13, -13), (-8, -8), (-3, -3), (2, 2), (7, 7), (12, 12)}
  | K2 => {(-13, 2, {11}), (-13, 7, {6}), (-13, 12, {1}), (-8, -3, {11}),
    (-8, 2, {6}), (-8, 7, {1}), (-8, 12, {-4}), (-3, -8, {11}), (-3, -3, {6}), (-3, 2, {1}),
    (-3, 7, {-4}), (-3, 12, {-9}), (2, -13, {11}), (2, -8, {6}), (2, -3, {1}), (2, 2, {-4}),
    (2, 7, {-9}), (7, -13, {6}), (7, -8, {1}), (7, -3, {-4}), (7, 2, {-9}), (12, -13, {1}),
    (12, -8, {-4}), (12, -3, {-9})}
  | K1 => {({-13}, {-9, -4}), ({-8}, {-4}), ({-8}, {-9, 1}),
    ({-3}, {-4, 1}), ({-3}, {-9, 6}), ({2}, {1}), ({2}, {-4, 6}), ({2}, {-9, 11}), ({7}, {1, 6}),
    ({7}, {-4, 11}), ({12}, {6}), ({12}, {1, 11})}
  | W4 => {(-13, -13, {-13}), (-13, -8, {-3}), (-13, -3, {7}),
    (-8, -8, {-8}), (-8, -3, {2}), (-8, 2, {12}), (-3, -8, {-13}), (-3, -3, {-3}), (-3, 2, {7}),
    (2, -3, {-8}), (2, 2, {2}), (2, 7, {12}), (7, -3, {-13}), (7, 2, {-3}), (7, 7, {7}),
    (12, 2, {-8}), (12, 7, {2}), (12, 12, {12})}
  | W3 => {(-13, {-13}), (-8, {-8}), (-8, {-13, -3}), (-3, {-3}),
    (-3, {-8, 2}), (-3, {-13, 7}), (2, {2}), (2, {-3, 7}), (2, {-8, 12}), (7, {7}),
    (7, {2, 12}), (12, {12})}
  | W2 => {(-13, {1, 6}), (-13, {-9, 11}), (-13, {1, 11}),
    (-13, {-4, 6, 11}), (-8, {-4, 6}), (-8, {1, 6}), (-8, {-4, 1, 11}), (-8, {-9, 6, 11}),
    (-3, {1}), (-3, {-9, 6}), (-3, {-4, 11}), (2, {-4, 1}), (2, {-4, 6}), (2, {-9, 1, 6}),
    (2, {-9, -4, 11}), (7, {-9, 1}), (7, {-4, 1}), (7, {-9, -4, 6}), (7, {-9, 11}), (12, {-4}),
    (12, {-9, 6})}
  | W1 => {({-13}, {1, 6}), ({-13}, {-9, 11}), ({-13}, {1, 11}),
    ({-13}, {-4, 6, 11}), ({-8}, {-4, 6}), ({-8}, {1, 6}), ({-8}, {-4, 1, 11}), ({-8}, {-9, 6, 11}),
    ({-3}, {1}), ({-3}, {-9, 6}), ({-3}, {-4, 11}), ({2}, {-4, 1}), ({2}, {-4, 6}),
    ({2}, {-9, 1, 6}), ({2}, {-9, -4, 11}), ({7}, {-9, 1}), ({7}, {-4, 1}), ({7}, {-9, -4, 6}),
    ({7}, {-9, 11}), ({12}, {-4}), ({12}, {-9, 6})}
  | Λ => {({-3}, {6}), ({-8, -3}, {11}), ({2}, {-4}), ({-13, 2}, {11}),
    ({-8, 2}, {6}), ({-3, 2}, {1}), ({-13, 7}, {6}), ({-8, 7}, {1}), ({-3, 7}, {-4}),
    ({2, 7}, {-9}), ({-13, 12}, {1}), ({-8, 12}, {-4}), ({-3, 12}, {-9})}
  | β => {(-13, {-13}), (-8, {-8}), (-3, {-3}), (2, {2}), (7, {7}),
    (12, {12})}
  | topYukawa => {(-13, {-9, -4}), (-8, {-4}), (-8, {-9, 1}), (-3, {-4, 1}),
    (-3, {-9, 6}), (2, {1}), (2, {-4, 6}), (2, {-9, 11}), (7, {1, 6}), (7, {-4, 11}), (12, {6}),
    (12, {1, 11})}
  | bottomYukawa => {(-13, {2}, {11}), (-13, {7}, {6}), (-13, {12}, {1}),
    (-8, {-3}, {11}), (-8, {2}, {6}), (-8, {7}, {1}), (-8, {12}, {-4}), (-3, {-8}, {11}),
    (-3, {-3}, {6}), (-3, {2}, {1}), (-3, {7}, {-4}), (-3, {12}, {-9}), (2, {-13}, {11}),
    (2, {-8}, {6}), (2, {-3}, {1}), (2, {2}, {-4}), (2, {7}, {-9}), (7, {-13}, {6}), (7, {-8}, {1}),
    (7, {-3}, {-4}), (7, {2}, {-9}), (12, {-13}, {1}), (12, {-8}, {-4}), (12, {-3}, {-9})}

def presentSubset : (I : CodimensionOneConfig) → (T : PotentialTerm) → Finset T.ChargeType
  | same, T => presentSubsetSame T
  | nearestNeighbor, T => presentSubsetNearest T
  | nextToNearestNeighbor, T => presentSubsetNextToNearest T

set_option maxRecDepth 2000 in
lemma isPresent_of_mem_presentSubset
    {I : CodimensionOneConfig} {T : PotentialTerm} (x : T.ChargeType) (h : x ∈ presentSubset I T) :
    IsPresent T x := by
  revert x
  revert T I
  decide


end PotentialTerm
end SU5U1
end FTheory
